import pandas as pd
import html

# Load your exact spreadsheet
# Ensure the file is named bios.csv in the same folder
df = pd.read_csv('bios.csv')

# These are the exact headers from your file
col_first = 'First Name '
col_last = 'Last Name'
col_role = 'Role '
col_shows = 'Previous Shows '
col_thanks = 'Thanks. '
col_verse = 'Unnamed: 5'

def clean(val):
    return html.escape(str(val).strip()) if pd.notna(val) and str(val).lower() != 'nan' else ""

bio_cards = ""

for _, row in df.iterrows():
    name = f"{clean(row[col_first])} {clean(row[col_last])}".strip()
    role = clean(row[col_role])
    shows = clean(row[col_shows])
    thanks = clean(row[col_thanks])
    verse = clean(row[col_verse])
    
    bio_cards += f"""
    <div class="bio-card">
        <span class="role">{role}</span>
        <h2>{name}</h2>
        {f'<div class="credits">Previous: {shows}</div>' if shows else ''}
        {f'<div class="thanks">"{thanks}"</div>' if thanks else ''}
        {f'<div class="verse">{verse}</div>' if verse else ''}
    </div>"""

# The Full HTML Wrapper
full_html = f"""
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello, Dolly! - Digital Playbill</title>
    <style>
        :root {{ --red: #c70f0f; --gold: #D4AF37; --white: #fff; --bg: #f4f4f4; }}
        body {{ font-family: sans-serif; background: var(--bg); margin: 0; padding: 0; }}
        header {{ background: var(--red); color: white; text-align: center; padding: 40px 20px; border-bottom: 5px solid var(--gold); }}
        .container {{ max-width: 600px; margin: auto; padding: 15px; }}
        .search-container {{ position: sticky; top: 10px; z-index: 1000; margin-bottom: 20px; }}
        #actorSearch {{ width: 100%; padding: 15px; border: 2px solid var(--red); border-radius: 10px; font-size: 1rem; box-sizing: border-box; }}
        .bio-card {{ background: var(--white); margin-bottom: 15px; padding: 20px; border-radius: 8px; border-left: 8px solid var(--red); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }}
        .role {{ font-weight: bold; color: var(--red); text-transform: uppercase; font-size: 0.8rem; display: block; margin-bottom: 5px; }}
        h2 {{ margin: 0 0 10px 0; font-size: 1.3rem; }}
        .credits {{ font-size: 0.85rem; color: #666; font-style: italic; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; }}
        .thanks {{ font-size: 0.95rem; margin-bottom: 10px; }}
        .verse {{ font-weight: bold; color: var(--red); font-size: 0.8rem; text-align: right; }}
        footer {{ text-align: center; padding: 40px 20px; color: #666; font-size: 0.85rem; border-top: 1px solid #ddd; background: #fff; }}
    </style>
</head>
<body>
    <header><h1>Hello, Dolly!</h1><p>Cast & Creative Team Bios</p></header>
    <div class="container">
        <div class="search-container"><input type="text" id="actorSearch" placeholder="Search..."></div>
        <div id="bioList">{bio_cards}</div>
    </div>
    <footer>
        <p>Grapevine Faith Christian School<br>Directed by Scott Werntz<br>Digital Playbill Design by Denis Kashoid 2026</p>
    </footer>
    <script>
        document.getElementById('actorSearch').addEventListener('input', function(e) {{
            let q = e.target.value.toLowerCase();
            for (let c of document.getElementsByClassName('bio-card')) {{
                c.style.display = c.innerText.toLowerCase().includes(q) ? 'block' : 'none';
            }}
        }});
    </script>
</body>
</html>
"""

with open('index.html', 'w', encoding='utf-8') as f:
    f.write(full_html)

print("Success! Your index.html has been generated with all bios.")
